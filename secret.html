<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine Wordle</title>

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #ffe6f2;
  display: flex;
  justify-content: center;
}

#container {
  width: 100%;
  max-width: 1200px;
  padding: 40px 20px;
  display: grid;
  gap: 50px;
}

.wordle {
  display: grid;
  gap: 6px;
  justify-content: center;
}

.row {
  display: grid;
  gap: 6px;
}

.cell {
  width: 60px;
  height: 60px;
  border: 2px solid #d3d6da;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 26px;
  font-weight: bold;
  text-transform: uppercase;
  background: white;
}

.correct {
  background: #538d4e;
  color: white;
  border: none;
}

.present {
  background: #b59f3b;
  color: white;
  border: none;
}

.absent {
  background: #787c7e;
  color: white;
  border: none;
}

.locked {
  opacity: 0.35;
  pointer-events: none;
}
</style>
</head>
<body>

<div id="container"></div>

<script>
const WORDS = ["will", "you", "be", "my", "valentine"];
const MAX_ATTEMPTS = 6;

const container = document.getElementById("container");

let currentGame = 0;
let currentRow = 0;
let currentGuess = "";
let games = [];

function createGame(word, index) {
  const wrapper = document.createElement("div");
  wrapper.classList.add("wordle");
  if (index !== 0) wrapper.classList.add("locked");

  wrapper.dataset.word = word;

  for (let r = 0; r < MAX_ATTEMPTS; r++) {
    const row = document.createElement("div");
    row.classList.add("row");
    row.style.gridTemplateColumns = `repeat(${word.length}, 60px)`;

    for (let c = 0; c < word.length; c++) {
      const cell = document.createElement("div");
      cell.classList.add("cell");
      row.appendChild(cell);
    }

    wrapper.appendChild(row);
  }

  container.appendChild(wrapper);
  games.push(wrapper);
}

WORDS.forEach((w, i) => createGame(w, i));

document.addEventListener("keydown", (e) => {
  const game = games[currentGame];
  if (!game || game.classList.contains("locked")) return;

  const word = game.dataset.word;

  if (e.key === "Backspace") {
    currentGuess = currentGuess.slice(0, -1);
    updateRow(game, word);
    return;
  }

  if (e.key === "Enter") {
    if (currentGuess.length === word.length) evaluateGuess(game, word);
    return;
  }

  if (/^[a-zA-Z]$/.test(e.key) && currentGuess.length < word.length) {
    currentGuess += e.key.toLowerCase();
    updateRow(game, word);
  }
});

function updateRow(game, word) {
  const row = game.children[currentRow];
  const cells = row.children;

  for (let i = 0; i < word.length; i++) {
    cells[i].textContent = currentGuess[i] || "";
  }
}

function evaluateGuess(game, word) {
  const row = game.children[currentRow];
  const cells = row.children;

  const guessArr = currentGuess.split("");
  const wordArr = word.split("");
  const used = Array(word.length).fill(false);

  // First pass: correct letters
  for (let i = 0; i < word.length; i++) {
    if (guessArr[i] === wordArr[i]) {
      cells[i].classList.add("correct");
      used[i] = true;
      guessArr[i] = null;
    }
  }

  // Second pass: present letters
  for (let i = 0; i < word.length; i++) {
    if (!guessArr[i]) continue;

    let found = false;
    for (let j = 0; j < word.length; j++) {
      if (!used[j] && guessArr[i] === wordArr[j]) {
        found = true;
        used[j] = true;
        break;
      }
    }

    if (found) {
      cells[i].classList.add("present");
    } else {
      cells[i].classList.add("absent");
    }
  }

  if (currentGuess === word) {
    unlockNext();
    return;
  }

  currentRow++;
  currentGuess = "";

  if (currentRow === MAX_ATTEMPTS) {
    currentRow = 0;
    currentGuess = "";
  }
}

function unlockNext() {
  currentGame++;
  currentRow = 0;
  currentGuess = "";

  if (currentGame < games.length) {
    games[currentGame].classList.remove("locked");
  } else {
    setTimeout(() => {
      alert("Will you be my Valentine? ðŸ’–");
    }, 200);
  }
}
</script>

</body>
</html>
